<div class="register-container">
  <div class="register-card animate">
    <div class="register-header">
      <h1 class="register-title">Crear Cuenta</h1>
      <p class="register-subtitle">Únete a HelpCore y gestiona tus tickets fácilmente</p>
    </div>

    <form class="register-form" [formGroup]="registroForm" (ngSubmit)="onSubmit()">

      <div class="form-grid">
        <!-- Nombres -->
        <div class="form-group">
          <div class="input-group">
            <div class="input-icon"><i class="bi bi-person"></i></div>
            <input type="text" formControlName="nombres" placeholder="Nombres" maxlength="100"
              [class.invalid]="isFieldInvalid('nombres')">
          </div>
          <span class="error-message" *ngIf="isFieldInvalid('nombres')">
            {{ getErrorMessage('nombres') }}
          </span>
        </div>

        <!-- Apellidos -->
        <div class="form-group">
          <div class="input-group">
            <div class="input-icon"><i class="bi bi-person"></i></div>
            <input type="text" formControlName="apellidos" placeholder="Apellidos" maxlength="100"
              [class.invalid]="isFieldInvalid('apellidos')">
          </div>
          <span class="error-message" *ngIf="isFieldInvalid('apellidos')">
            {{ getErrorMessage('apellidos') }}
          </span>
        </div>

        <!-- DNI -->
        <div class="form-group">
          <div class="input-group">
            <div class="input-icon"><i class="bi bi-card-text"></i></div>
            <input type="text" formControlName="dni" placeholder="DNI (8 dígitos)" maxlength="8"
              [class.invalid]="isFieldInvalid('dni')">
          </div>
          <span class="error-message" *ngIf="isFieldInvalid('dni')">
            {{ getErrorMessage('dni') }}
          </span>
        </div>

        <!-- Teléfono -->
        <div class="form-group">
          <div class="input-group">
            <div class="input-icon"><i class="bi bi-telephone"></i></div>
            <input type="text" formControlName="telefono" placeholder="Teléfono móvil (9 dígitos, inicia con 9)"
              maxlength="9" [class.invalid]="isFieldInvalid('telefono')">
          </div>
          <span class="error-message" *ngIf="isFieldInvalid('telefono')">
            {{ getErrorMessage('telefono') }}
          </span>
        </div>

        <!-- Código de alumno -->
        <div class="form-group">
          <div class="input-group">
            <div class="input-icon"><i class="bi bi-mortarboard"></i></div>
            <input type="text" formControlName="codigo" placeholder="Código de alumno (ej: i12345678)" maxlength="9"
              [class.invalid]="isFieldInvalid('codigo')">
          </div>
          <span class="error-message" *ngIf="isFieldInvalid('codigo')">
            {{ getErrorMessage('codigo') }}
          </span>
        </div>

        <!-- Sede -->
        <div class="form-group">
          <div class="input-group">
            <div class="input-icon"><i class="bi bi-building"></i></div>
            <select formControlName="sede" [class.invalid]="isFieldInvalid('sede')">
              <option value="">— Seleccionar —</option>
              <option *ngFor="let s of sedes" [value]="s.id">{{ s.nombre }}</option>
            </select>
          </div>
          <span class="error-message" *ngIf="isFieldInvalid('sede')">{{ getErrorMessage('sede') }}</span>
          <small *ngIf="sedes.length === 0" class="text-muted">No hay sedes disponibles</small>
        </div>

        <!-- Correo -->
        <div class="form-group">
          <div class="input-group">
            <div class="input-icon"><i class="bi bi-envelope"></i></div>
            <input type="email" formControlName="correo" placeholder="Correo electrónico activo" maxlength="100"
              [class.invalid]="isFieldInvalid('correo')">
          </div>
          <span class="error-message" *ngIf="isFieldInvalid('correo')">
            {{ getErrorMessage('correo') }}
          </span>
        </div>

        <!-- Contraseña -->
        <div class="form-group">
          <div class="input-group">
            <div class="input-icon"><i class="bi bi-lock"></i></div>
            <input type="password" formControlName="contrasena" placeholder="Contraseña (mínimo 6 caracteres)"
              maxlength="50" [class.invalid]="isFieldInvalid('contrasena')">
          </div>
          <span class="error-message" *ngIf="isFieldInvalid('contrasena')">
            {{ getErrorMessage('contrasena') }}
          </span>
        </div>
      </div>

      <button type="submit" class="btn-primary w-100" [disabled]="loading">
        <span *ngIf="!loading">
          <i class="bi bi-person-plus"></i>
          Registrarse
        </span>
        <span *ngIf="loading" class="spinner"></span>
      </button>

      <div class="form-footer">
        <a class="secondary-link" [routerLink]="['/login']">
          ¿Ya tienes una cuenta? Inicia sesión
        </a>
      </div>
    </form>

    <div class="register-footer">
      <p class="brand-text">
        <i class="bi bi-ticket-perforated"></i>
        HelpCore
      </p>
      <p class="copyright">Sistema de gestión de tickets</p>
    </div>
  </div>
</div>